(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{76276:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/register",function(){return t(81504)}])},81504:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return register}});var s=t(85893),i=t(80822),r=t(15861),n=t(23795),l=t(10781),o=t(49300),d=t(62173),c=t(32488),u=t(82175),m=t(67294),p=t(2525),h=t(94532),g=t(18842),x=t(86704),f=t(11163),v=t(55074),w=t(33837),j=t(96841),b=t(53946),y=t(15985),Z=t(93791),A=t(45007),S=t(91444),_=t(41935),C=t(41296),N=t(74231),k=t(58518),P=t(5121),O=t(98691);let useRegister=()=>{let e=(0,A.I0)(),a=(0,f.useRouter)(),[t,s]=(0,m.useState)(!1),[i,r]=(0,m.useState)(""),[n,l]=(0,m.useState)(!1),[o,d]=(0,m.useState)(!1),[c,u]=(0,m.useState)(!1),[p,h]=(0,m.useState)(""),g=N.Ry().shape({name:N.Z_().required("Name is required!").min(3,""),email:N.Z_().email("Invalid email!").required("Email is required!"),password:N.Z_().required("Password is required!").matches(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$/,"Password must conatin one uppercase, lowercase, special symbol and number."),recaptcha:N.Z_().required("ReCaptcha is required")}),onSubmit=async t=>{let{email:n,password:o,name:u}=t;l(!0);try{if(!c){S.Am.error("Captcha is not verified, Please reload this page and try again"),l(!1);return}let t=await P.Z.post("/otp/verifyMail",{email:n,otp:i});if(t.data.status)d(!0),S.Am.success(t.data.message),s(!1),l(!1);else{l(!1),S.Am.error(t.data.message),s(!1),r("");return}try{var m;let t;let s=await new Promise((e,a)=>{(0,y.iH)(n,o,u,async(s,i)=>{s?a(s):(e(i),t=await i.getIdToken(!0))})});if(console.log(s),!(null==s?void 0:s.uid)){S.Am.error("Authentication failed. No UID found."),l(!1);return}let i=await k.Z.post("/client/user",{userId:s.uid});if(!(null===(m=i.data)||void 0===m?void 0:m.isVerified)){(0,y.o0)(e),l(!1);return}await updateCart(),setupUserSession(i.data,t),S.Am.success("Account created Successfully"),a.push("/projects")}catch(a){S.Am.error("Signup failed: "+(a.message||"Unknown error")),(0,y.o0)(e)}finally{l(!1)}}catch(e){S.Am.error(e.message||"Unknown error")}},updateCart=async()=>{var a;let t=await k.Z.get("client/cart");(null===(a=t.data)||void 0===a?void 0:a._id)&&(e((0,O.TV)(t.data._id)),t.data.items.forEach(a=>{e((0,O.Xq)({courseId:a._id,name:a.name,price:a.price}))}))},setupUserSession=(a,t)=>{let s={email:a.email,name:a.name,uid:a.uid};(0,Z.Vn)("token",t),(0,Z.Vn)("cart",a.cartId._id),e((0,_.av)(s)),e((0,C.In)(a))},handleOtpVerification=async(e,a)=>{let t=await P.Z.post("/captcha/verify",{token:p});if(t.data.success)u(!0);else{S.Am.error("Captcha is not verified, Please relaod page and try again"),u(!1);return}let i=await P.Z.post("/otp/mail",{email:e,name:a});i.data.status?(S.Am.success(i.data.message),s(!0)):"Already sent OTP, Please verify with it before expire"===i.data.message?(S.Am.warning(i.data.message),s(!0)):(S.Am.error(i.data.message),s(!1))};return{signUpSchema:g,onSubmit,setIsMailVerified:d,isMailVerified:o,handleOtpVerification,openModal:t,setOpenModal:s,setOtp:r,otp:i,isLoading:n,setCaptchaToken:h}};var components_Modal=e=>{let{isOpen:a,onClose:t,title:i,desc:r,children:n}=e;return a?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-filter backdrop-blur-sm flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-lg w-full m-4",children:[(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold",children:i}),(0,s.jsx)("p",{className:"pb-2 text-sm font-light",children:r})]}),(0,s.jsx)("div",{className:"mt-4",children:n})]})}):null};let OtpInput=e=>{let{otp:a,setOtp:t}=e,handleChange=(e,s)=>{let i=Array.from(a);i[s]=e.value,t(i.join("")),e.value&&e.nextSibling&&e.nextSibling.focus()};return(0,s.jsx)("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((e,t)=>(0,s.jsx)("input",{className:"w-12 h-12 text-center text-xl form-control rounded border-2",type:"text",maxLength:1,value:a[t]||"",onChange:e=>handleChange(e.target,t),onFocus:e=>e.target.select()},t))})};var register=()=>{let[e,a]=(0,m.useState)("password"),t=(0,f.useRouter)(),{signUpSchema:y,onSubmit:Z,isMailVerified:A,openModal:S,handleOtpVerification:_,otp:C,setOtp:N,isLoading:k,setCaptchaToken:P}=useRegister(),{values:O,isSubmitting:E,touched:I,errors:T,handleSubmit:q,handleChange:V,setFieldValue:R}=(0,u.TA)({initialValues:{email:"",password:"",name:"",recaptcha:""},validationSchema:y,onSubmit:e=>_(e.email,e.name)});return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(l.Z,{title:"SignUp",image:"images/login/login-banner.png",children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.Z,{title:"Join and Get Exclusive Access | NullClass",description:"Join NullClass for a hands-on learning adventure. Register to gain real-time project experience and elevate your skills with our live, interactive projects."}),(0,s.jsx)(d.Z,{onSubmit:q,children:(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(x.X6,{children:"Sign Up"}),(0,s.jsx)(c.Z,{id:"name",name:"name",label:"Full Name",type:"text",value:O.name,touched:I.name,error:null==T?void 0:T.name,onChange:V}),(0,s.jsx)(c.Z,{id:"email",name:"email",label:"Email",type:"email",placeholder:"Enter your email",value:O.email,touched:I.email,error:null==T?void 0:T.email,onChange:V,disabled:A}),(0,s.jsx)(components_Modal,{isOpen:S,title:"Please Enter the 6-Digit OTP Here",desc:"Please check your mail inbox and submit the OTP within 5 Minutes",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(OtpInput,{otp:C,setOtp:N}),(0,s.jsx)("button",{className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",type:"button",onClick:()=>Z(O),children:k?"Creating Account...":"Submit OTP"})]})}),(0,s.jsxs)(x.yH,{children:[(0,s.jsx)(c.Z,{id:"password",name:"password",label:"Password",type:e,value:O.password,touched:I.password,error:null==T?void 0:T.password,onChange:V}),(0,s.jsx)(x.Wf,{children:"password"===e?(0,s.jsx)(p.Z,{onClick:()=>{a("text")}}):(0,s.jsx)(h.Z,{onClick:()=>{a("password")}})})]}),(0,s.jsx)(v.Z,{setFieldValue:R,setCaptchaToken:P}),(0,s.jsx)(w.BD,{children:(null==I?void 0:I.recaptcha)&&(null==T?void 0:T.recaptcha)}),k?null:(0,s.jsx)(o.Z,{variant:"outlined",title:k?"Account creating...":"Sign up",type:"submit",isLoading:k,disabled:k}),(0,s.jsx)(x.P2,{children:(0,s.jsx)(r.Z,{children:(0,s.jsx)(n.Z,{href:"/forgot-password",sx:{fontWeight:"600",color:"#3563B8"},children:"Forgot login or password?"})})}),(0,s.jsx)(g.Z,{title:"or sign up with"}),(0,s.jsx)(x.us,{children:(0,s.jsx)(j.Z,{})}),(0,s.jsx)(g.Z,{title:"already have an account?"}),(0,s.jsx)(o.Z,{onClick:()=>{t.push("/login")},variant:"outlined",title:"Log in"})]})})]})})})}}},function(e){e.O(0,[8717,5675,5615,3615,9417,8288,6705,129,7383,8808,9774,2888,179],function(){return e(e.s=76276)}),_N_E=e.O()}]);